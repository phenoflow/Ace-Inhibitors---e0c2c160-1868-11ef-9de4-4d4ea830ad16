# Tim Doran, Evangelos Kontopantelis, Jose M Valderas, Stephen Campbell, Martin Roland, Chris Salisbury, David Reeves, 2024.

import sys, csv, re

codes = [{"code":"2786001","system":"gprdproduct"},{"code":"9141001","system":"gprdproduct"},{"code":"237001","system":"gprdproduct"},{"code":"12595001","system":"gprdproduct"},{"code":"65002","system":"gprdproduct"},{"code":"5262009","system":"gprdproduct"},{"code":"1070009","system":"gprdproduct"},{"code":"2116007","system":"gprdproduct"},{"code":"2919002","system":"gprdproduct"},{"code":"2467001","system":"gprdproduct"},{"code":"6151009","system":"gprdproduct"},{"code":"13650001","system":"gprdproduct"},{"code":"1915009","system":"gprdproduct"},{"code":"2966001","system":"gprdproduct"},{"code":"1661011","system":"gprdproduct"},{"code":"4810009","system":"gprdproduct"},{"code":"1887009","system":"gprdproduct"},{"code":"5913009","system":"gprdproduct"},{"code":"8534001","system":"gprdproduct"},{"code":"11782002","system":"gprdproduct"},{"code":"7290001","system":"gprdproduct"},{"code":"7082002","system":"gprdproduct"},{"code":"7162003","system":"gprdproduct"},{"code":"3365001","system":"gprdproduct"},{"code":"6704009","system":"gprdproduct"},{"code":"2371002","system":"gprdproduct"},{"code":"8955003","system":"gprdproduct"},{"code":"1909001","system":"gprdproduct"},{"code":"2783003","system":"gprdproduct"},{"code":"11577001","system":"gprdproduct"},{"code":"616002","system":"gprdproduct"},{"code":"889009","system":"gprdproduct"},{"code":"5936009","system":"gprdproduct"},{"code":"10008001","system":"gprdproduct"},{"code":"6488009","system":"gprdproduct"},{"code":"11782001","system":"gprdproduct"},{"code":"4813009","system":"gprdproduct"},{"code":"2708007","system":"gprdproduct"},{"code":"2850009","system":"gprdproduct"},{"code":"6065009","system":"gprdproduct"},{"code":"1341001","system":"gprdproduct"},{"code":"14840001","system":"gprdproduct"},{"code":"5931001","system":"gprdproduct"},{"code":"6940003","system":"gprdproduct"},{"code":"6406009","system":"gprdproduct"},{"code":"4003009","system":"gprdproduct"},{"code":"5591003","system":"gprdproduct"},{"code":"5907009","system":"gprdproduct"},{"code":"6940002","system":"gprdproduct"},{"code":"764009","system":"gprdproduct"},{"code":"6229002","system":"gprdproduct"},{"code":"2485002","system":"gprdproduct"},{"code":"4843009","system":"gprdproduct"},{"code":"616001","system":"gprdproduct"},{"code":"14575001","system":"gprdproduct"},{"code":"4479009","system":"gprdproduct"},{"code":"540010","system":"gprdproduct"},{"code":"3013009","system":"gprdproduct"},{"code":"11576003","system":"gprdproduct"},{"code":"2786002","system":"gprdproduct"},{"code":"7299003","system":"gprdproduct"},{"code":"7265001","system":"gprdproduct"},{"code":"3715009","system":"gprdproduct"},{"code":"2804003","system":"gprdproduct"},{"code":"2783002","system":"gprdproduct"},{"code":"2796001","system":"gprdproduct"},{"code":"3396009","system":"gprdproduct"},{"code":"3591001","system":"gprdproduct"},{"code":"5085007","system":"gprdproduct"},{"code":"4595003","system":"gprdproduct"},{"code":"5906009","system":"gprdproduct"},{"code":"1000001","system":"gprdproduct"},{"code":"6028009","system":"gprdproduct"},{"code":"1661009","system":"gprdproduct"},{"code":"6118009","system":"gprdproduct"},{"code":"4192009","system":"gprdproduct"},{"code":"3839007","system":"gprdproduct"},{"code":"6122009","system":"gprdproduct"},{"code":"294002","system":"gprdproduct"},{"code":"377001","system":"gprdproduct"},{"code":"247011","system":"gprdproduct"},{"code":"6256009","system":"gprdproduct"},{"code":"8374003","system":"gprdproduct"},{"code":"7082001","system":"gprdproduct"},{"code":"10615002","system":"gprdproduct"},{"code":"6066009","system":"gprdproduct"},{"code":"3592002","system":"gprdproduct"},{"code":"10590001","system":"gprdproduct"},{"code":"5988009","system":"gprdproduct"},{"code":"5903009","system":"gprdproduct"},{"code":"6086009","system":"gprdproduct"},{"code":"1070010","system":"gprdproduct"},{"code":"5832009","system":"gprdproduct"},{"code":"3114001","system":"gprdproduct"},{"code":"14045001","system":"gprdproduct"},{"code":"354009","system":"gprdproduct"},{"code":"5956009","system":"gprdproduct"},{"code":"5263009","system":"gprdproduct"},{"code":"1070011","system":"gprdproduct"},{"code":"2804001","system":"gprdproduct"},{"code":"3013011","system":"gprdproduct"},{"code":"13838001","system":"gprdproduct"},{"code":"1950011","system":"gprdproduct"},{"code":"7290002","system":"gprdproduct"},{"code":"3133009","system":"gprdproduct"},{"code":"1638002","system":"gprdproduct"},{"code":"9219003","system":"gprdproduct"},{"code":"13569001","system":"gprdproduct"},{"code":"875011","system":"gprdproduct"},{"code":"10615001","system":"gprdproduct"},{"code":"1498010","system":"gprdproduct"},{"code":"3731010","system":"gprdproduct"},{"code":"4466002","system":"gprdproduct"},{"code":"248010","system":"gprdproduct"},{"code":"2709007","system":"gprdproduct"},{"code":"2197010","system":"gprdproduct"},{"code":"9573001","system":"gprdproduct"},{"code":"8955001","system":"gprdproduct"},{"code":"14442001","system":"gprdproduct"},{"code":"7187001","system":"gprdproduct"},{"code":"5990009","system":"gprdproduct"},{"code":"7935001","system":"gprdproduct"},{"code":"7185002","system":"gprdproduct"},{"code":"5840009","system":"gprdproduct"},{"code":"540009","system":"gprdproduct"},{"code":"9219001","system":"gprdproduct"},{"code":"6468002","system":"gprdproduct"},{"code":"8403002","system":"gprdproduct"},{"code":"5590003","system":"gprdproduct"},{"code":"4006001","system":"gprdproduct"},{"code":"4197001","system":"gprdproduct"},{"code":"877009","system":"gprdproduct"},{"code":"7265002","system":"gprdproduct"},{"code":"4446001","system":"gprdproduct"},{"code":"8717001","system":"gprdproduct"},{"code":"2840007","system":"gprdproduct"},{"code":"14819001","system":"gprdproduct"},{"code":"2784001","system":"gprdproduct"},{"code":"1311009","system":"gprdproduct"},{"code":"6229009","system":"gprdproduct"},{"code":"2806001","system":"gprdproduct"},{"code":"1004002","system":"gprdproduct"},{"code":"11131003","system":"gprdproduct"},{"code":"14283001","system":"gprdproduct"},{"code":"6508009","system":"gprdproduct"},{"code":"4555001","system":"gprdproduct"},{"code":"10789003","system":"gprdproduct"},{"code":"14831001","system":"gprdproduct"},{"code":"1001002","system":"gprdproduct"},{"code":"12602001","system":"gprdproduct"},{"code":"3660009","system":"gprdproduct"},{"code":"6230009","system":"gprdproduct"},{"code":"14030001","system":"gprdproduct"},{"code":"3688010","system":"gprdproduct"},{"code":"12598001","system":"gprdproduct"},{"code":"3463009","system":"gprdproduct"},{"code":"4812009","system":"gprdproduct"},{"code":"6706009","system":"gprdproduct"},{"code":"5899009","system":"gprdproduct"},{"code":"3613007","system":"gprdproduct"},{"code":"4806009","system":"gprdproduct"},{"code":"1269001","system":"gprdproduct"},{"code":"1909002","system":"gprdproduct"},{"code":"5933009","system":"gprdproduct"},{"code":"4002009","system":"gprdproduct"},{"code":"6193009","system":"gprdproduct"},{"code":"5876009","system":"gprdproduct"},{"code":"6545003","system":"gprdproduct"},{"code":"467010","system":"gprdproduct"},{"code":"1912002","system":"gprdproduct"},{"code":"1638001","system":"gprdproduct"},{"code":"3874009","system":"gprdproduct"},{"code":"8403001","system":"gprdproduct"},{"code":"7264002","system":"gprdproduct"},{"code":"5833009","system":"gprdproduct"},{"code":"5895009","system":"gprdproduct"},{"code":"5431001","system":"gprdproduct"},{"code":"8949002","system":"gprdproduct"},{"code":"3232001","system":"gprdproduct"},{"code":"2808001","system":"gprdproduct"},{"code":"3804007","system":"gprdproduct"},{"code":"3592001","system":"gprdproduct"},{"code":"3757009","system":"gprdproduct"},{"code":"5711007","system":"gprdproduct"},{"code":"8160001","system":"gprdproduct"},{"code":"6117009","system":"gprdproduct"},{"code":"5914009","system":"gprdproduct"},{"code":"65003","system":"gprdproduct"},{"code":"877010","system":"gprdproduct"},{"code":"248011","system":"gprdproduct"},{"code":"305001","system":"gprdproduct"},{"code":"2220010","system":"gprdproduct"},{"code":"3014001","system":"gprdproduct"},{"code":"377002","system":"gprdproduct"},{"code":"5591002","system":"gprdproduct"},{"code":"2896009","system":"gprdproduct"},{"code":"6150009","system":"gprdproduct"},{"code":"1864009","system":"gprdproduct"},{"code":"4529009","system":"gprdproduct"},{"code":"2263002","system":"gprdproduct"},{"code":"14366001","system":"gprdproduct"},{"code":"6940001","system":"gprdproduct"},{"code":"5902009","system":"gprdproduct"},{"code":"14213001","system":"gprdproduct"},{"code":"3881009","system":"gprdproduct"},{"code":"14576001","system":"gprdproduct"},{"code":"302001","system":"gprdproduct"},{"code":"1889009","system":"gprdproduct"},{"code":"831009","system":"gprdproduct"},{"code":"1004001","system":"gprdproduct"},{"code":"1260009","system":"gprdproduct"},{"code":"6775009","system":"gprdproduct"},{"code":"10498001","system":"gprdproduct"},{"code":"1565010","system":"gprdproduct"},{"code":"2796002","system":"gprdproduct"},{"code":"14533001","system":"gprdproduct"},{"code":"13980001","system":"gprdproduct"},{"code":"2807001","system":"gprdproduct"},{"code":"1003003","system":"gprdproduct"},{"code":"2859010","system":"gprdproduct"},{"code":"5991009","system":"gprdproduct"},{"code":"5619009","system":"gprdproduct"},{"code":"4161007","system":"gprdproduct"},{"code":"4596001","system":"gprdproduct"},{"code":"6469001","system":"gprdproduct"},{"code":"7868002","system":"gprdproduct"},{"code":"9219002","system":"gprdproduct"},{"code":"6941003","system":"gprdproduct"},{"code":"2197009","system":"gprdproduct"},{"code":"2919001","system":"gprdproduct"},{"code":"2968001","system":"gprdproduct"},{"code":"1569010","system":"gprdproduct"},{"code":"1684001","system":"gprdproduct"},{"code":"5934009","system":"gprdproduct"},{"code":"7621001","system":"gprdproduct"},{"code":"366009","system":"gprdproduct"},{"code":"4189009","system":"gprdproduct"},{"code":"7290003","system":"gprdproduct"},{"code":"8374001","system":"gprdproduct"},{"code":"3323009","system":"gprdproduct"},{"code":"12596001","system":"gprdproduct"},{"code":"2783001","system":"gprdproduct"},{"code":"2216001","system":"gprdproduct"},{"code":"1050002","system":"gprdproduct"},{"code":"1002001","system":"gprdproduct"},{"code":"3365003","system":"gprdproduct"},{"code":"1684002","system":"gprdproduct"},{"code":"2707007","system":"gprdproduct"},{"code":"365009","system":"gprdproduct"},{"code":"6983002","system":"gprdproduct"},{"code":"3882009","system":"gprdproduct"},{"code":"5955009","system":"gprdproduct"},{"code":"9574001","system":"gprdproduct"},{"code":"3365002","system":"gprdproduct"},{"code":"2913001","system":"gprdproduct"},{"code":"6272009","system":"gprdproduct"},{"code":"12804001","system":"gprdproduct"},{"code":"5880009","system":"gprdproduct"},{"code":"1449002","system":"gprdproduct"},{"code":"12805001","system":"gprdproduct"},{"code":"13155001","system":"gprdproduct"},{"code":"6420002","system":"gprdproduct"},{"code":"6191009","system":"gprdproduct"},{"code":"2797001","system":"gprdproduct"},{"code":"6230002","system":"gprdproduct"},{"code":"1614010","system":"gprdproduct"},{"code":"2217001","system":"gprdproduct"},{"code":"6190009","system":"gprdproduct"},{"code":"6707009","system":"gprdproduct"},{"code":"7716001","system":"gprdproduct"},{"code":"3428009","system":"gprdproduct"},{"code":"5916009","system":"gprdproduct"},{"code":"5164001","system":"gprdproduct"},{"code":"6404009","system":"gprdproduct"},{"code":"8373001","system":"gprdproduct"},{"code":"5952009","system":"gprdproduct"},{"code":"6507009","system":"gprdproduct"},{"code":"546009","system":"gprdproduct"},{"code":"5777007","system":"gprdproduct"},{"code":"5954009","system":"gprdproduct"},{"code":"6029009","system":"gprdproduct"},{"code":"6311009","system":"gprdproduct"},{"code":"6851001","system":"gprdproduct"},{"code":"875010","system":"gprdproduct"},{"code":"2088011","system":"gprdproduct"},{"code":"9223001","system":"gprdproduct"},{"code":"3011001","system":"gprdproduct"},{"code":"5878009","system":"gprdproduct"},{"code":"5912009","system":"gprdproduct"},{"code":"6555009","system":"gprdproduct"},{"code":"5879009","system":"gprdproduct"},{"code":"831010","system":"gprdproduct"},{"code":"5915009","system":"gprdproduct"},{"code":"3590003","system":"gprdproduct"},{"code":"5950009","system":"gprdproduct"},{"code":"9095001","system":"gprdproduct"},{"code":"4783009","system":"gprdproduct"},{"code":"3590002","system":"gprdproduct"},{"code":"14282001","system":"gprdproduct"},{"code":"11576002","system":"gprdproduct"},{"code":"1568009","system":"gprdproduct"},{"code":"6499009","system":"gprdproduct"},{"code":"4847009","system":"gprdproduct"},{"code":"8955002","system":"gprdproduct"},{"code":"3880009","system":"gprdproduct"},{"code":"4099001","system":"gprdproduct"},{"code":"2805001","system":"gprdproduct"},{"code":"5910009","system":"gprdproduct"},{"code":"14286001","system":"gprdproduct"},{"code":"3396010","system":"gprdproduct"},{"code":"878009","system":"gprdproduct"},{"code":"5897009","system":"gprdproduct"},{"code":"14031001","system":"gprdproduct"},{"code":"13157001","system":"gprdproduct"},{"code":"2740009","system":"gprdproduct"},{"code":"1908002","system":"gprdproduct"},{"code":"3012002","system":"gprdproduct"},{"code":"3592003","system":"gprdproduct"},{"code":"13890001","system":"gprdproduct"},{"code":"2871009","system":"gprdproduct"},{"code":"567009","system":"gprdproduct"},{"code":"6545002","system":"gprdproduct"},{"code":"1950010","system":"gprdproduct"},{"code":"6405009","system":"gprdproduct"},{"code":"764010","system":"gprdproduct"},{"code":"3463010","system":"gprdproduct"},{"code":"2263001","system":"gprdproduct"},{"code":"14620001","system":"gprdproduct"},{"code":"5474007","system":"gprdproduct"},{"code":"467009","system":"gprdproduct"},{"code":"3083011","system":"gprdproduct"},{"code":"12591001","system":"gprdproduct"},{"code":"1008001","system":"gprdproduct"},{"code":"1523001","system":"gprdproduct"},{"code":"466010","system":"gprdproduct"},{"code":"7081001","system":"gprdproduct"},{"code":"2806003","system":"gprdproduct"},{"code":"6705009","system":"gprdproduct"},{"code":"4841009","system":"gprdproduct"},{"code":"3013001","system":"gprdproduct"},{"code":"1614009","system":"gprdproduct"},{"code":"2220009","system":"gprdproduct"},{"code":"2841007","system":"gprdproduct"},{"code":"1010002","system":"gprdproduct"},{"code":"14970001","system":"gprdproduct"},{"code":"1449001","system":"gprdproduct"},{"code":"12600001","system":"gprdproduct"},{"code":"368009","system":"gprdproduct"},{"code":"1350011","system":"gprdproduct"},{"code":"1920009","system":"gprdproduct"},{"code":"7624003","system":"gprdproduct"},{"code":"5877009","system":"gprdproduct"},{"code":"3011002","system":"gprdproduct"},{"code":"4838009","system":"gprdproduct"},{"code":"14561001","system":"gprdproduct"},{"code":"5911009","system":"gprdproduct"},{"code":"10789001","system":"gprdproduct"},{"code":"2302009","system":"gprdproduct"},{"code":"6228009","system":"gprdproduct"},{"code":"5165003","system":"gprdproduct"},{"code":"7081002","system":"gprdproduct"},{"code":"7624002","system":"gprdproduct"},{"code":"1235009","system":"gprdproduct"},{"code":"2102007","system":"gprdproduct"},{"code":"2103007","system":"gprdproduct"},{"code":"3439009","system":"gprdproduct"},{"code":"7185001","system":"gprdproduct"},{"code":"1671002","system":"gprdproduct"},{"code":"2838007","system":"gprdproduct"},{"code":"4809009","system":"gprdproduct"},{"code":"1912001","system":"gprdproduct"},{"code":"302002","system":"gprdproduct"},{"code":"6403009","system":"gprdproduct"},{"code":"3520007","system":"gprdproduct"},{"code":"6026009","system":"gprdproduct"},{"code":"13950001","system":"gprdproduct"},{"code":"1569009","system":"gprdproduct"},{"code":"2839007","system":"gprdproduct"},{"code":"545009","system":"gprdproduct"},{"code":"4467002","system":"gprdproduct"},{"code":"354011","system":"gprdproduct"},{"code":"7098001","system":"gprdproduct"},{"code":"12604001","system":"gprdproduct"},{"code":"12201001","system":"gprdproduct"},{"code":"3872009","system":"gprdproduct"},{"code":"2220011","system":"gprdproduct"},{"code":"5776007","system":"gprdproduct"},{"code":"629009","system":"gprdproduct"},{"code":"66001","system":"gprdproduct"},{"code":"6170009","system":"gprdproduct"},{"code":"7654001","system":"gprdproduct"},{"code":"6205009","system":"gprdproduct"},{"code":"878010","system":"gprdproduct"},{"code":"14289001","system":"gprdproduct"},{"code":"3012001","system":"gprdproduct"},{"code":"10591002","system":"gprdproduct"},{"code":"1523002","system":"gprdproduct"},{"code":"7185003","system":"gprdproduct"},{"code":"7162002","system":"gprdproduct"},{"code":"7081003","system":"gprdproduct"},{"code":"3840009","system":"gprdproduct"},{"code":"294001","system":"gprdproduct"},{"code":"2466002","system":"gprdproduct"},{"code":"5883009","system":"gprdproduct"},{"code":"544009","system":"gprdproduct"},{"code":"8374002","system":"gprdproduct"},{"code":"365010","system":"gprdproduct"},{"code":"5590001","system":"gprdproduct"},{"code":"6230001","system":"gprdproduct"},{"code":"1319010","system":"gprdproduct"},{"code":"13154001","system":"gprdproduct"},{"code":"6204009","system":"gprdproduct"},{"code":"11131001","system":"gprdproduct"},{"code":"9494001","system":"gprdproduct"},{"code":"367009","system":"gprdproduct"},{"code":"6027009","system":"gprdproduct"},{"code":"12803001","system":"gprdproduct"},{"code":"6063009","system":"gprdproduct"},{"code":"1523003","system":"gprdproduct"},{"code":"1351009","system":"gprdproduct"},{"code":"7868001","system":"gprdproduct"},{"code":"3021009","system":"gprdproduct"},{"code":"8948003","system":"gprdproduct"},{"code":"3757010","system":"gprdproduct"},{"code":"4468001","system":"gprdproduct"},{"code":"6467001","system":"gprdproduct"},{"code":"7426001","system":"gprdproduct"},{"code":"5931002","system":"gprdproduct"},{"code":"11821001","system":"gprdproduct"},{"code":"5839009","system":"gprdproduct"},{"code":"4595002","system":"gprdproduct"},{"code":"5908009","system":"gprdproduct"},{"code":"4840009","system":"gprdproduct"},{"code":"368011","system":"gprdproduct"},{"code":"823001","system":"gprdproduct"},{"code":"12599001","system":"gprdproduct"},{"code":"6119009","system":"gprdproduct"},{"code":"1638003","system":"gprdproduct"},{"code":"6556009","system":"gprdproduct"},{"code":"8948002","system":"gprdproduct"},{"code":"6545001","system":"gprdproduct"},{"code":"6121009","system":"gprdproduct"},{"code":"1350009","system":"gprdproduct"},{"code":"67001","system":"gprdproduct"},{"code":"5909009","system":"gprdproduct"},{"code":"6983003","system":"gprdproduct"},{"code":"12603001","system":"gprdproduct"},{"code":"5393001","system":"gprdproduct"},{"code":"541011","system":"gprdproduct"},{"code":"3590001","system":"gprdproduct"},{"code":"4467003","system":"gprdproduct"},{"code":"1003001","system":"gprdproduct"},{"code":"7624001","system":"gprdproduct"},{"code":"3302009","system":"gprdproduct"},{"code":"5953009","system":"gprdproduct"},{"code":"3022010","system":"gprdproduct"},{"code":"366010","system":"gprdproduct"},{"code":"307001","system":"gprdproduct"},{"code":"368010","system":"gprdproduct"},{"code":"2089009","system":"gprdproduct"},{"code":"6420001","system":"gprdproduct"},{"code":"2088009","system":"gprdproduct"},{"code":"3715010","system":"gprdproduct"},{"code":"5227009","system":"gprdproduct"},{"code":"6187009","system":"gprdproduct"},{"code":"4782009","system":"gprdproduct"},{"code":"8356001","system":"gprdproduct"},{"code":"2808002","system":"gprdproduct"},{"code":"6539007","system":"gprdproduct"},{"code":"5334009","system":"gprdproduct"},{"code":"1684003","system":"gprdproduct"},{"code":"3259009","system":"gprdproduct"},{"code":"1429009","system":"gprdproduct"},{"code":"3536007","system":"gprdproduct"},{"code":"294003","system":"gprdproduct"},{"code":"5393002","system":"gprdproduct"},{"code":"1565009","system":"gprdproduct"},{"code":"2044007","system":"gprdproduct"},{"code":"5617009","system":"gprdproduct"},{"code":"12597001","system":"gprdproduct"},{"code":"13570001","system":"gprdproduct"},{"code":"8781001","system":"gprdproduct"},{"code":"7082003","system":"gprdproduct"},{"code":"7299001","system":"gprdproduct"},{"code":"6467002","system":"gprdproduct"},{"code":"3149007","system":"gprdproduct"},{"code":"366011","system":"gprdproduct"},{"code":"3302010","system":"gprdproduct"},{"code":"3871009","system":"gprdproduct"},{"code":"65001","system":"gprdproduct"},{"code":"14969001","system":"gprdproduct"},{"code":"2871010","system":"gprdproduct"},{"code":"2337002","system":"gprdproduct"},{"code":"2706007","system":"gprdproduct"},{"code":"5590002","system":"gprdproduct"},{"code":"119001","system":"gprdproduct"},{"code":"5544007","system":"gprdproduct"},{"code":"7162001","system":"gprdproduct"},{"code":"1799001","system":"gprdproduct"},{"code":"4466003","system":"gprdproduct"},{"code":"6290009","system":"gprdproduct"},{"code":"13158001","system":"gprdproduct"},{"code":"13637001","system":"gprdproduct"},{"code":"6498009","system":"gprdproduct"},{"code":"1661010","system":"gprdproduct"},{"code":"5335009","system":"gprdproduct"},{"code":"544010","system":"gprdproduct"},{"code":"2796003","system":"gprdproduct"},{"code":"67002","system":"gprdproduct"},{"code":"13156001","system":"gprdproduct"},{"code":"5882009","system":"gprdproduct"},{"code":"2804002","system":"gprdproduct"},{"code":"5896009","system":"gprdproduct"},{"code":"4466001","system":"gprdproduct"},{"code":"541009","system":"gprdproduct"},{"code":"2115007","system":"gprdproduct"},{"code":"1001001","system":"gprdproduct"},{"code":"248009","system":"gprdproduct"},{"code":"14440001","system":"gprdproduct"},{"code":"2216002","system":"gprdproduct"},{"code":"2807002","system":"gprdproduct"},{"code":"14246001","system":"gprdproduct"},{"code":"2089010","system":"gprdproduct"},{"code":"1050001","system":"gprdproduct"},{"code":"6229001","system":"gprdproduct"},{"code":"3553010","system":"gprdproduct"},{"code":"1908001","system":"gprdproduct"},{"code":"365011","system":"gprdproduct"},{"code":"8645001","system":"gprdproduct"},{"code":"13514001","system":"gprdproduct"},{"code":"1887010","system":"gprdproduct"},{"code":"9575001","system":"gprdproduct"},{"code":"3351001","system":"gprdproduct"},{"code":"6123009","system":"gprdproduct"},{"code":"1639001","system":"gprdproduct"},{"code":"6060009","system":"gprdproduct"},{"code":"3903007","system":"gprdproduct"},{"code":"2859009","system":"gprdproduct"},{"code":"1010001","system":"gprdproduct"},{"code":"7299002","system":"gprdproduct"},{"code":"1319011","system":"gprdproduct"},{"code":"11822001","system":"gprdproduct"},{"code":"13153001","system":"gprdproduct"},{"code":"546010","system":"gprdproduct"},{"code":"13395001","system":"gprdproduct"},{"code":"10789002","system":"gprdproduct"},{"code":"2485001","system":"gprdproduct"},{"code":"3302011","system":"gprdproduct"},{"code":"5986009","system":"gprdproduct"},{"code":"5165001","system":"gprdproduct"},{"code":"5265009","system":"gprdproduct"},{"code":"14290001","system":"gprdproduct"},{"code":"4197003","system":"gprdproduct"},{"code":"2371001","system":"gprdproduct"},{"code":"354010","system":"gprdproduct"},{"code":"2918002","system":"gprdproduct"},{"code":"3351002","system":"gprdproduct"},{"code":"7264001","system":"gprdproduct"},{"code":"7141002","system":"gprdproduct"},{"code":"12477001","system":"gprdproduct"},{"code":"5987009","system":"gprdproduct"},{"code":"12594001","system":"gprdproduct"},{"code":"12202001","system":"gprdproduct"},{"code":"6061009","system":"gprdproduct"},{"code":"2050007","system":"gprdproduct"},{"code":"1071001","system":"gprdproduct"},{"code":"875009","system":"gprdproduct"},{"code":"3083010","system":"gprdproduct"},{"code":"4249007","system":"gprdproduct"},{"code":"4595001","system":"gprdproduct"},{"code":"7197002","system":"gprdproduct"},{"code":"1920010","system":"gprdproduct"},{"code":"5898009","system":"gprdproduct"},{"code":"12593001","system":"gprdproduct"},{"code":"12601001","system":"gprdproduct"},{"code":"6188009","system":"gprdproduct"},{"code":"12969001","system":"gprdproduct"},{"code":"2966003","system":"gprdproduct"},{"code":"2278010","system":"gprdproduct"},{"code":"1887011","system":"gprdproduct"},{"code":"3591002","system":"gprdproduct"},{"code":"1003002","system":"gprdproduct"},{"code":"11576001","system":"gprdproduct"},{"code":"6120009","system":"gprdproduct"},{"code":"1920011","system":"gprdproduct"},{"code":"10591001","system":"gprdproduct"},{"code":"1888009","system":"gprdproduct"},{"code":"247010","system":"gprdproduct"},{"code":"2278009","system":"gprdproduct"},{"code":"6469002","system":"gprdproduct"},{"code":"5431003","system":"gprdproduct"},{"code":"2088010","system":"gprdproduct"},{"code":"3011003","system":"gprdproduct"},{"code":"2216003","system":"gprdproduct"},{"code":"5591001","system":"gprdproduct"},{"code":"5989009","system":"gprdproduct"},{"code":"6468001","system":"gprdproduct"},{"code":"3757011","system":"gprdproduct"},{"code":"4100001","system":"gprdproduct"},{"code":"5881009","system":"gprdproduct"},{"code":"6487009","system":"gprdproduct"},{"code":"1924009","system":"gprdproduct"},{"code":"238001","system":"gprdproduct"},{"code":"541010","system":"gprdproduct"},{"code":"1429010","system":"gprdproduct"},{"code":"4467001","system":"gprdproduct"},{"code":"3439010","system":"gprdproduct"},{"code":"7141001","system":"gprdproduct"},{"code":"4445001","system":"gprdproduct"},{"code":"1319009","system":"gprdproduct"},{"code":"545010","system":"gprdproduct"},{"code":"1482001","system":"gprdproduct"},{"code":"2320007","system":"gprdproduct"},{"code":"10590002","system":"gprdproduct"},{"code":"6703009","system":"gprdproduct"},{"code":"2597007","system":"gprdproduct"},{"code":"8949001","system":"gprdproduct"},{"code":"8534002","system":"gprdproduct"},{"code":"2805002","system":"gprdproduct"},{"code":"8948001","system":"gprdproduct"},{"code":"542009","system":"gprdproduct"},{"code":"13542001","system":"gprdproduct"},{"code":"6470009","system":"gprdproduct"},{"code":"4842009","system":"gprdproduct"},{"code":"247009","system":"gprdproduct"},{"code":"5164002","system":"gprdproduct"},{"code":"14285001","system":"gprdproduct"},{"code":"629010","system":"gprdproduct"},{"code":"6227009","system":"gprdproduct"},{"code":"4596002","system":"gprdproduct"},{"code":"367011","system":"gprdproduct"},{"code":"2806002","system":"gprdproduct"},{"code":"5834009","system":"gprdproduct"},{"code":"2466001","system":"gprdproduct"},{"code":"3553009","system":"gprdproduct"},{"code":"2814009","system":"gprdproduct"},{"code":"7197001","system":"gprdproduct"},{"code":"367010","system":"gprdproduct"},{"code":"6312009","system":"gprdproduct"},{"code":"3688011","system":"gprdproduct"},{"code":"6506009","system":"gprdproduct"},{"code":"10591003","system":"gprdproduct"},{"code":"1950009","system":"gprdproduct"},{"code":"3875009","system":"gprdproduct"},{"code":"14764001","system":"gprdproduct"},{"code":"7717001","system":"gprdproduct"},{"code":"466009","system":"gprdproduct"},{"code":"6983001","system":"gprdproduct"},{"code":"2966002","system":"gprdproduct"},{"code":"1565011","system":"gprdproduct"},{"code":"12592001","system":"gprdproduct"},{"code":"5894009","system":"gprdproduct"},{"code":"5935009","system":"gprdproduct"},{"code":"4555003","system":"gprdproduct"},{"code":"5165002","system":"gprdproduct"},{"code":"5900009","system":"gprdproduct"},{"code":"5164003","system":"gprdproduct"},{"code":"3266007","system":"gprdproduct"},{"code":"14288001","system":"gprdproduct"},{"code":"4197002","system":"gprdproduct"},{"code":"6189009","system":"gprdproduct"},{"code":"8949003","system":"gprdproduct"},{"code":"6472009","system":"gprdproduct"},{"code":"3232002","system":"gprdproduct"},{"code":"5618009","system":"gprdproduct"},{"code":"1498009","system":"gprdproduct"},{"code":"2233009","system":"gprdproduct"},{"code":"2089011","system":"gprdproduct"},{"code":"10768001","system":"gprdproduct"},{"code":"5951009","system":"gprdproduct"},{"code":"14513001","system":"gprdproduct"},{"code":"4555002","system":"gprdproduct"},{"code":"12806001","system":"gprdproduct"},{"code":"3022009","system":"gprdproduct"},{"code":"2337001","system":"gprdproduct"},{"code":"6229003","system":"gprdproduct"},{"code":"1671001","system":"gprdproduct"},{"code":"9573002","system":"gprdproduct"},{"code":"3083009","system":"gprdproduct"},{"code":"3688009","system":"gprdproduct"},{"code":"12893001","system":"gprdproduct"},{"code":"6176009","system":"gprdproduct"},{"code":"6192009","system":"gprdproduct"},{"code":"8954001","system":"gprdproduct"},{"code":"11131002","system":"gprdproduct"},{"code":"6062009","system":"gprdproduct"},{"code":"3439011","system":"gprdproduct"},{"code":"10991001","system":"gprdproduct"},{"code":"5500009","system":"gprdproduct"},{"code":"7197003","system":"gprdproduct"},{"code":"11603001","system":"gprdproduct"},{"code":"4811009","system":"gprdproduct"},{"code":"6941002","system":"gprdproduct"},{"code":"5901009","system":"gprdproduct"},{"code":"823002","system":"gprdproduct"},{"code":"4530009","system":"gprdproduct"},{"code":"6509009","system":"gprdproduct"},{"code":"764011","system":"gprdproduct"},{"code":"1350010","system":"gprdproduct"},{"code":"6941001","system":"gprdproduct"},{"code":"3731009","system":"gprdproduct"},{"code":"10590003","system":"gprdproduct"},{"code":"14465001","system":"gprdproduct"},{"code":"6173009","system":"gprdproduct"},{"code":"14466001","system":"gprdproduct"},{"code":"6064009","system":"gprdproduct"},{"code":"2918001","system":"gprdproduct"},{"code":"14284001","system":"gprdproduct"},{"code":"5431002","system":"gprdproduct"},{"code":"3013010","system":"gprdproduct"},{"code":"12808001","system":"gprdproduct"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('ace-inhibitors-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["ace---primary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["ace---primary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["ace---primary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
